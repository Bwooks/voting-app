{"version":3,"sources":["../../../voting-server/src/server.js"],"names":["startServer","http","require","express","socketio","path","store","PORT","process","env","INDEX","join","__dirname","app","server","createServer","io","listen","use","static","get","req","res","sendFile","on","socket","emit","getState","toJS","dispatch","bind","subscribe"],"mappings":";;;;;kBAOwBA,W;AAPxB;;;AAGA,IAAMC,OAAOC,QAAQ,MAAR,CAAb;AACA,IAAMC,UAAUD,QAAQ,SAAR,CAAhB;AACA,IAAME,WAAWF,QAAQ,WAAR,CAAjB;AACA,IAAMG,OAAOH,QAAQ,MAAR,CAAb;AACe,SAASF,WAAT,CAAqBM,KAArB,EAA2B;;AAEtC,QAAMC,OAAOC,QAAQC,GAAR,CAAYF,IAAZ,IAAoB,IAAjC;AACA,QAAMG,QAAQL,KAAKM,IAAL,CAAUC,SAAV,EAAoB,OAApB,EAA4B,eAA5B,EAA4C,iBAA5C,CAAd;AACA,QAAMC,MAAMV,SAAZ;AACA,QAAMW,SAASb,KAAKc,YAAL,CAAkBF,GAAlB,CAAf;AACA,QAAMG,KAAKZ,SAASa,MAAT,CAAgBH,MAAhB,CAAX;AACAA,WAAOG,MAAP,CAAcV,IAAd;;AAEAM,QAAIK,GAAJ,CAAQf,QAAQgB,MAAR,CAAed,KAAKM,IAAL,CAAUC,SAAV,EAAoB,OAApB,EAA4B,oBAA5B,CAAf,CAAR;AACAC,QAAIO,GAAJ,CAAQ,GAAR,EAAY,UAACC,GAAD,EAAKC,GAAL,EAAW;AACnBA,YAAIC,QAAJ,CAAab,KAAb;AACH,KAFD;;AAIAM,OAAGQ,EAAH,CAAM,YAAN,EAAmB,UAACC,MAAD,EAAU;AACzBA,eAAOC,IAAP,CAAY,OAAZ,EAAoBpB,MAAMqB,QAAN,GAAiBC,IAAjB,EAApB;AACAH,eAAOD,EAAP,CAAU,QAAV,EAAmBlB,MAAMuB,QAAN,CAAeC,IAAf,CAAoBxB,KAApB,CAAnB;AACH,KAHD;;AAKAA,UAAMyB,SAAN,CAAgB,YAAI;AAChBf,WAAGU,IAAH,CAAQ,OAAR,EAAgBpB,MAAMqB,QAAN,GAAiBC,IAAjB,EAAhB;AACH,KAFD;AAGH","file":"server.js","sourcesContent":["/**\r\n * Created by Owner on 1/11/2017.\r\n */\r\nconst http = require('http');\r\nconst express = require('express');\r\nconst socketio = require('socket.io');\r\nconst path = require('path');\r\nexport default function startServer(store){\r\n\r\n    const PORT = process.env.PORT || 8080;\r\n    const INDEX = path.join(__dirname,\"../..\",\"voting-client\",\"dist/index.html\");\r\n    const app = express();\r\n    const server = http.createServer(app);\r\n    const io = socketio.listen(server);\r\n    server.listen(PORT);\r\n\r\n    app.use(express.static(path.join(__dirname,\"../..\",\"voting-client/dist\")));\r\n    app.get(\"*\",(req,res)=>{\r\n        res.sendFile(INDEX);\r\n    });\r\n\r\n    io.on(\"connection\",(socket)=>{\r\n        socket.emit(\"state\",store.getState().toJS());\r\n        socket.on(\"action\",store.dispatch.bind(store));\r\n    });\r\n\r\n    store.subscribe(()=>{\r\n        io.emit(\"state\",store.getState().toJS());\r\n    });\r\n}"]}